[file name]: payments.html
[file content begin]
<!DOCTYPE html>
<html class="no-js" lang="zxx">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kalenjin Vibes | Payments</title>
  <meta name="author" content="Kalenjin Vibes">
  <meta name="description" content="Secure payment processing for events, talent bookings, and merchandise.">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#BA0909',
            secondary: '#222',
            light: '#f8f9fa',
            dark: '#1a1a1a'
          },
          fontFamily: {
            'jost': ['Jost', 'sans-serif']
          }
        }
      }
    }
  </script>
  
  <!-- SweetAlert2 CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z93DQW5D1S"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Z93DQW5D1S');
  </script>
  
  <style>
    /* Mobile Menu Styles - Only minimal CSS */
    .mobile-menu-modal {
        display: none;
    }
    
    .mobile-menu-modal.active {
        display: block;
    }
    
    .mobile-menu-content {
        transform: translateX(100%);
        transition: transform 0.3s ease;
    }
    
    .mobile-menu-modal.active .mobile-menu-content {
        transform: translateX(0);
    }
    
    .mobile-menu-nav a:hover {
        background: #f9f9f9;
        color: #BA0909;
    }
    
    /* WhatsApp Button */
    .whatsapp-button-payments {
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 1000;
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #25D366, #128C7E);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        text-decoration: none;
    }
    
    .whatsapp-button-payments:hover {
        transform: scale(1.1) translateY(-3px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
    }
    
    .whatsapp-button-payments img {
        width: 35px;
        height: 35px;
        filter: brightness(0) invert(1);
    }
    
    /* Custom copy button styles */
    .copy-btn-inline {
        background: #28a745;
        border: none;
        color: white;
        padding: 6px 14px;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-size: 13px;
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
        margin-left: 10px;
        vertical-align: middle;
    }
    
    .copy-btn-inline:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
        background: #218838;
    }
    
    /* Transaction input */
    #transaction_reference {
        font-family: 'Courier New', monospace;
        letter-spacing: 1.5px;
        text-transform: uppercase;
    }
  </style>
</head>
<body class="font-jost bg-gray-50">

  <!-- Mobile Menu Modal -->
  <div id="mobileMenuModal" class="mobile-menu-modal fixed inset-0 z-50 bg-black bg-opacity-50">
    <div class="mobile-menu-content absolute top-0 right-0 w-80 h-full bg-white overflow-y-auto">
      <div class="mobile-menu-header flex justify-between items-center p-4 bg-primary text-white">
        <h3 class="text-lg font-bold">Menu</h3>
        <button onclick="closeMobileMenu()" class="mobile-menu-close bg-none border-none text-white text-xl cursor-pointer">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <nav class="mobile-menu-nav py-4">
        <ul>
          <li class="border-b border-gray-100">
            <a href="index.html" class="block px-4 py-3 text-gray-800 hover:text-primary">
              <i class="fas fa-home w-6 text-center mr-3"></i> Home
            </a>
          </li>
          <li class="border-b border-gray-100">
            <a href="eventslist.html" class="block px-4 py-3 text-gray-800 hover:text-primary">
              <i class="fas fa-calendar-alt w-6 text-center mr-3"></i> Events
            </a>
          </li>
          <li class="border-b border-gray-100">
            <a href="talentlist.html" class="block px-4 py-3 text-gray-800 hover:text-primary">
              <i class="fas fa-users w-6 text-center mr-3"></i> Talent
            </a>
          </li>
          <li class="border-b border-gray-100">
            <a href="shop.html" class="block px-4 py-3 text-gray-800 hover:text-primary">
              <i class="fas fa-shopping-bag w-6 text-center mr-3"></i> Shop
            </a>
          </li>
          <li class="border-b border-gray-100">
            <a href="payments.html" class="block px-4 py-3 text-gray-800 hover:text-primary">
              <i class="fas fa-credit-card w-6 text-center mr-3"></i> Payments
            </a>
          </li>
          <li class="border-b border-gray-100">
            <a href="about.html" class="block px-4 py-3 text-gray-800 hover:text-primary">
              <i class="fas fa-info-circle w-6 text-center mr-3"></i> About
            </a>
          </li>
          <li class="border-b border-gray-100">
            <a href="contact.html" class="block px-4 py-3 text-gray-800 hover:text-primary">
              <i class="fas fa-envelope w-6 text-center mr-3"></i> Contact
            </a>
          </li>
        </ul>
      </nav>
      <div class="mobile-menu-footer p-4 border-t border-gray-200 text-center">
        <div class="social-icons flex justify-center gap-3 mb-3">
          <a href="#" class="social-icon w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center text-gray-800 hover:bg-primary hover:text-white">
            <i class="fab fa-facebook-f"></i>
          </a>
          <a href="#" class="social-icon w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center text-gray-800 hover:bg-primary hover:text-white">
            <i class="fab fa-twitter"></i>
          </a>
          <a href="#" class="social-icon w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center text-gray-800 hover:bg-primary hover:text-white">
            <i class="fab fa-instagram"></i>
          </a>
        </div>
        <p class="copyright text-xs text-gray-500">¬© <span class="current-year"></span> Kalenjin Vibes</p>
      </div>
    </div>
  </div>

  <!-- Header -->
  <div id="header-container"></div>

  <!-- Breadcrumb -->
  <div class="relative bg-cover bg-center py-16" style="background-image: linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(186, 9, 9, 0.8)), url('assets/img/breadcumb/breadcumb-bg.jpg');">
    <div class="container mx-auto px-4">
      <div class="relative z-10 text-center">
        <h1 class="text-3xl md:text-4xl font-bold text-white mb-4">Make Payment</h1>
        <div class="flex justify-center">
          <ul class="flex list-none p-0 m-0 text-sm md:text-base">
            <li class="mx-2">
              <a href="index.html" class="text-white hover:text-gray-200 transition-colors">Home</a>
            </li>
            <li class="mx-2 text-gray-300">/</li>
            <li class="mx-2 text-white font-medium">Payments</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Payment Form Section -->
  <div class="container mx-auto px-4 py-8">
    <div class="max-w-3xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden">
      <!-- Order Summary -->
      <div id="orderSummary" class="p-6 border-b border-gray-200" style="display: none;">
        <h5 class="text-xl font-bold text-gray-800 mb-4">Order Summary</h5>
        <div id="order-items" class="mb-4"></div>
        <div class="order-total pt-4 border-t border-gray-200">
          <div class="flex justify-between items-center">
            <span class="text-lg font-medium">Total:</span>
            <span id="total-amount-display" class="text-2xl font-bold text-primary">Ksh 0</span>
          </div>
        </div>
      </div>
      
      <!-- Booking Summary -->
      <div id="bookingSummary" class="p-6 border-b border-gray-200" style="display: none;">
        <h5 class="text-xl font-bold text-gray-800 mb-4">Booking Summary</h5>
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <p class="mb-2"><strong class="text-gray-700">Talent:</strong> <span id="summaryTalentName" class="text-gray-900"></span></p>
          <p class="mb-2"><strong class="text-gray-700">Event:</strong> <span id="summaryEventName" class="text-gray-900">Kalenjin Vibes Night</span></p>
          <p class="mb-0"><strong class="text-gray-700">Amount:</strong> <span id="summaryAmount" class="text-primary font-bold"></span></p>
        </div>
      </div>

      <!-- Payment Form -->
      <form id="payment-form" class="p-6">
        <input type="hidden" id="bookingType" name="booking_type" value="">
        <input type="hidden" id="bookingTalentId" name="talent_id" value="">
        <input type="hidden" id="bookingTalentName" name="talent_name" value="">
        <input type="hidden" id="bookingEventName" name="event_name" value="Kalenjin Vibes Night">
        <input type="hidden" id="bookingLocation" name="location" value="">
        <input type="hidden" id="bookingEventDate" name="event_date" value="">
        <input type="hidden" id="bookingAmount" name="amount" value="">
        <input type="hidden" id="bookingNotes" name="notes" value="">
        
        <!-- Contact Information -->
        <div class="mb-8">
          <h5 class="text-xl font-bold text-gray-800 mb-6">Contact Information</h5>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="full_name" class="block text-sm font-medium text-gray-700 mb-2">
                <i class="fas fa-user text-primary mr-2"></i> Full Name <span class="text-red-500">*</span>
              </label>
              <input class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" 
                     id="full_name" name="full_name" type="text" placeholder="Enter your full name" required>
            </div>
            <div>
              <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                <i class="fas fa-envelope text-primary mr-2"></i> Email <span class="text-red-500">*</span>
              </label>
              <input class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" 
                     id="email" name="email" type="email" placeholder="your@email.com" required>
            </div>
            <div>
              <label for="phone_number" class="block text-sm font-medium text-gray-700 mb-2">
                <i class="fas fa-phone text-primary mr-2"></i> Phone <span class="text-red-500">*</span>
              </label>
              <input class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" 
                     id="phone_number" name="phone_number" type="text" placeholder="07XX XXX XXX" required>
            </div>
          </div>
        </div>

        <!-- Payment Method Selection -->
        <div class="mb-8">
          <label for="payment_method" class="block text-center text-lg font-medium text-gray-700 mb-4">
            <i class="fas fa-credit-card text-primary mr-2"></i> Select Payment Method
          </label>
          <select class="w-full max-w-xs mx-auto px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" 
                  id="payment_method" name="payment_method" required>
            <option value="">Choose method...</option>
            <option value="mpesa">üì± M-Pesa Till</option>
            <option value="paybill">üè¢ Paybill</option>
          </select>
        </div>

        <!-- M-Pesa Instructions -->
        <div id="mpesa-details" class="mb-6" style="display: none;">
          <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
            <div class="text-center mb-6">
              <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/M-PESA_LOGO-01.svg/2560px-M-PESA_LOGO-01.svg.png" 
                   class="max-w-[150px] mx-auto mb-4" alt="M-Pesa">
              <h4 class="text-xl font-bold text-gray-800"><u>LIPA NA MPESA</u></h4>
            </div>
            <ul class="space-y-3">
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">1</span>
                <span>Go to M-PESA on your phone</span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">2</span>
                <span>Select <strong>Lipa Na M-PESA</strong></span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">3</span>
                <span>Select <strong>Buy Goods and Services</strong></span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">4</span>
                <span>Enter Till: <strong class="text-green-600 ml-2">3049015</strong>
                  <button type="button" class="copy-btn-inline" onclick="copyToClipboard('3049015', this)">
                    <i class="fas fa-copy"></i> Copy
                  </button>
                </span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">5</span>
                <span>Enter Amount: <strong class="text-green-600 ml-2" id="mpesaAmount">Ksh 0</strong></span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">6</span>
                <span>Enter your M-PESA PIN and confirm</span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">7</span>
                <span>After payment, enter Transaction Code below</span>
              </li>
            </ul>
            <p class="text-center text-sm text-gray-600 mt-4">
              <i class="fas fa-info-circle text-primary mr-1"></i> Copy Till Number above
            </p>
          </div>
        </div>

        <!-- Paybill Instructions -->
        <div id="paybill-details" class="mb-6" style="display: none;">
          <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
            <div class="text-center mb-6">
              <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/M-PESA_LOGO-01.svg/2560px-M-PESA_LOGO-01.svg.png" 
                   class="max-w-[150px] mx-auto mb-4" alt="M-Pesa">
              <h4 class="text-xl font-bold text-gray-800"><u>LIPA NA MPESA - PAYBILL</u></h4>
            </div>
            <ul class="space-y-3">
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">1</span>
                <span>Go to M-PESA on your phone</span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">2</span>
                <span>Select <strong>Lipa Na M-PESA</strong></span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">3</span>
                <span>Select <strong>Pay Bill</strong></span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">4</span>
                <span>Enter Business No: <strong class="text-green-600 ml-2">542542</strong>
                  <button type="button" class="copy-btn-inline" onclick="copyToClipboard('542542', this)">
                    <i class="fas fa-copy"></i> Copy
                  </button>
                </span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">5</span>
                <span>Enter Account No: <strong class="text-green-600 ml-2">79233</strong>
                  <button type="button" class="copy-btn-inline" onclick="copyToClipboard('79233', this)">
                    <i class="fas fa-copy"></i> Copy
                  </button>
                </span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">6</span>
                <span>Enter Amount: <strong class="text-green-600 ml-2" id="paybillAmount">Ksh 0</strong></span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">7</span>
                <span>Enter your M-PESA PIN and confirm</span>
              </li>
              <li class="flex items-start">
                <span class="bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm mr-3 mt-0.5">8</span>
                <span>After payment, enter Transaction Code below</span>
              </li>
            </ul>
            <p class="text-center text-sm text-gray-600 mt-4">
              <i class="fas fa-info-circle text-primary mr-1"></i> Copy numbers above
            </p>
          </div>
        </div>

        <!-- Transaction Reference -->
        <div class="mb-8" id="transaction-reference-group" style="display: none;">
          <label for="transaction_reference" class="block text-sm font-medium text-gray-700 mb-2">
            <i class="fas fa-receipt text-primary mr-2"></i> Transaction Code <span class="text-red-500">*</span>
          </label>
          <input type="text" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" 
                 id="transaction_reference" name="transaction_reference" placeholder="Paste M-Pesa message or enter code" required>
          <small class="block text-sm text-gray-500 mt-2">
            <i class="fas fa-info-circle text-primary mr-1"></i> Paste entire M-Pesa SMS or type code (auto uppercase)
          </small>
          <div id="transaction-error" class="text-red-600 mt-2" style="display: none;">
            <i class="fas fa-exclamation-circle mr-1"></i> Enter transaction code
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg transition-colors duration-300 flex items-center justify-center">
            <i class="fas fa-check-circle mr-2"></i> Complete Purchase
          </button>
          <button type="button" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-8 rounded-lg transition-colors duration-300 flex items-center justify-center" id="cancel-btn">
            <i class="fas fa-times mr-2"></i> Cancel
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Footer -->
  <div id="footer-container"></div>

  <!-- Scroll To Top -->
  <a href="#" class="scrollToTop fixed bottom-8 right-8 bg-primary text-white p-3 rounded-full shadow-lg hover:bg-red-800 transition-colors duration-300 z-50 hidden">
    <i class="fas fa-arrow-up"></i>
  </a>
  
  <!-- WhatsApp Button -->
  <a href="https://wa.me/+254797265275" class="whatsapp-button-payments fixed bottom-5 left-5 z-40 w-14 h-14 bg-gradient-to-br from-green-500 to-green-600 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110" target="_blank" title="Chat with us on WhatsApp">
    <img src="assets/img/WhatsApp.svg" alt="WhatsApp" class="w-8 h-8 filter brightness-0 invert">
  </a>

  <!-- JavaScript Files -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  
  <!-- Global Mobile Menu Functions -->
  <script>
    // Global mobile menu functions
    window.openMobileMenu = function() {
      console.log('Opening mobile menu...');
      const modal = document.getElementById('mobileMenuModal');
      if (modal) {
        modal.classList.add('active');
        document.body.classList.add('overflow-hidden');
        console.log('Menu opened!');
      } else {
        console.error('Modal not found!');
      }
    };

    window.closeMobileMenu = function() {
      console.log('Closing mobile menu...');
      const modal = document.getElementById('mobileMenuModal');
      if (modal) {
        modal.classList.remove('active');
        document.body.classList.remove('overflow-hidden');
        console.log('Menu closed!');
      }
    };

    // Close on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        window.closeMobileMenu();
      }
    });
  </script>

  <!-- Load Header and Footer -->
  <script>
    // Load header
    fetch('partials/header.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('header-container').innerHTML = data;
        
        // Attach click handlers after header loads
        setTimeout(function() {
          const menuToggle = document.querySelector('.vs-menu-toggle');
          if (menuToggle) {
            menuToggle.addEventListener('click', function() {
              window.openMobileMenu();
            });
          }
          
          // Close menu when clicking links
          const menuLinks = document.querySelectorAll('.mobile-menu-nav a');
          menuLinks.forEach(link => {
            link.addEventListener('click', function() {
              setTimeout(window.closeMobileMenu, 200);
            });
          });
        }, 100);
      })
      .catch(error => console.error('Error loading header:', error));
      
    // Load footer
    fetch('partials/footer.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('footer-container').innerHTML = data;
        
        // Set current year in footer
        const yearElements = document.querySelectorAll('.current-year');
        yearElements.forEach(element => {
          element.textContent = new Date().getFullYear();
        });
      })
      .catch(error => console.error('Error loading footer:', error));
  </script>
  
  <!-- Scroll to Top Script -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const scrollToTopBtn = document.querySelector('.scrollToTop');
      
      window.addEventListener('scroll', function() {
        if (window.pageYOffset > 300) {
          scrollToTopBtn.classList.remove('hidden');
        } else {
          scrollToTopBtn.classList.add('hidden');
        }
      });
      
      scrollToTopBtn.addEventListener('click', function(e) {
        e.preventDefault();
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
    });
  </script>

  <!-- Payment JavaScript -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      
      // Get URL parameters
      const urlParams = new URLSearchParams(window.location.search);
      const bookingType = urlParams.get('type');
      const amount = urlParams.get('amount');
      const talentId = urlParams.get('talent_id');
      const talentName = urlParams.get('talent_name');
      
      // Helper functions
      function setFieldValue(id, value) {
        const field = document.getElementById(id);
        if (field && value) field.value = value;
      }
      
      function setTextContent(id, value) {
        const element = document.getElementById(id);
        if (element && value) element.textContent = value;
      }
      
      // Populate fields
      if (bookingType) setFieldValue('bookingType', bookingType);
      if (amount) {
        setFieldValue('bookingAmount', amount);
        setTextContent('mpesaAmount', 'Ksh ' + amount);
        setTextContent('paybillAmount', 'Ksh ' + amount);
        setTextContent('total-amount-display', 'Ksh ' + amount);
        setTextContent('summaryAmount', 'Ksh ' + amount);
      }
      if (talentId) setFieldValue('bookingTalentId', talentId);
      if (talentName) {
        setFieldValue('bookingTalentName', talentName);
        setTextContent('summaryTalentName', talentName);
      }
      
      // Show booking summary if talent booking
      if (bookingType === 'talent' && talentName) {
        const bookingSummary = document.getElementById('bookingSummary');
        if (bookingSummary) bookingSummary.style.display = 'block';
      }
      
      // Show order summary if event ticket
      if (bookingType === 'event_ticket') {
        const orderSummary = document.getElementById('orderSummary');
        if (orderSummary) orderSummary.style.display = 'block';
      }
      
      // Payment method change
      const paymentMethodSelect = document.getElementById('payment_method');
      if (paymentMethodSelect) {
        paymentMethodSelect.addEventListener('change', function() {
          const method = this.value;
          const mpesaDetails = document.getElementById('mpesa-details');
          const paybillDetails = document.getElementById('paybill-details');
          const transactionGroup = document.getElementById('transaction-reference-group');
          
          if (mpesaDetails) mpesaDetails.style.display = 'none';
          if (paybillDetails) paybillDetails.style.display = 'none';
          if (transactionGroup) transactionGroup.style.display = 'none';
          
          if (method === 'mpesa' && mpesaDetails && transactionGroup) {
            mpesaDetails.style.display = 'block';
            transactionGroup.style.display = 'block';
          } else if (method === 'paybill' && paybillDetails && transactionGroup) {
            paybillDetails.style.display = 'block';
            transactionGroup.style.display = 'block';
          }
        });
      }
      
      // Transaction code handling
      const transactionInput = document.getElementById('transaction_reference');
      if (transactionInput) {
        // Auto uppercase
        transactionInput.addEventListener('input', function() {
          const cursorPos = this.selectionStart;
          this.value = this.value.toUpperCase();
          this.setSelectionRange(cursorPos, cursorPos);
        });
      }
      
      // Copy to clipboard function
      window.copyToClipboard = function(text, button) {
        if (navigator.clipboard) {
          navigator.clipboard.writeText(text).then(() => {
            const original = button.innerHTML;
            button.innerHTML = '<i class="fas fa-check"></i>';
            button.classList.remove('bg-green-600');
            button.classList.add('bg-green-700');
            
            setTimeout(() => {
              button.innerHTML = original;
              button.classList.remove('bg-green-700');
              button.classList.add('bg-green-600');
            }, 1500);
          });
        }
      };
      
      // Form submission
      const paymentForm = document.getElementById('payment-form');
      if (paymentForm) {
        paymentForm.addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const paymentMethod = document.getElementById('payment_method').value;
          let transactionRef = document.getElementById('transaction_reference').value.trim().toUpperCase();
          
          // Validate
          if (!paymentMethod) {
            Swal.fire({
              icon: 'error',
              title: 'Select Method',
              text: 'Choose M-Pesa or Paybill',
              confirmButtonColor: '#BA0909'
            });
            return;
          }
          
          if (!transactionRef) {
            document.getElementById('transaction_reference').focus();
            Swal.fire({
              icon: 'error',
              title: 'Enter Code',
              text: 'Enter M-Pesa transaction code',
              confirmButtonColor: '#BA0909'
            });
            return;
          }
          
          // Show loading
          Swal.fire({
            title: 'Processing...',
            allowOutsideClick: false,
            didOpen: () => Swal.showLoading()
          });
          
          // Simulate processing
          setTimeout(() => {
            Swal.close();
            
            // Show success message
            Swal.fire({
              icon: 'success',
              title: 'Payment Submitted!',
              html: `
                <div class="text-center">
                  <p class="mb-3">Your payment has been received.</p>
                  <div class="bg-gray-100 p-4 rounded-lg mb-4">
                    <p class="mb-1"><strong>Transaction Code:</strong></p>
                    <p class="font-mono text-lg font-bold">${transactionRef}</p>
                    <p class="mt-2"><strong>Amount:</strong> Ksh ${amount || '0'}</p>
                  </div>
                  <p class="text-sm text-gray-600">You will receive a confirmation email shortly.</p>
                </div>
              `,
              confirmButtonColor: '#BA0909',
              confirmButtonText: 'Back to Home'
            }).then((result) => {
              if (result.isConfirmed) {
                window.location.href = 'index.html';
              }
            });
          }, 2000);
        });
      }
      
      // Cancel button
      const cancelBtn = document.getElementById('cancel-btn');
      if (cancelBtn) {
        cancelBtn.addEventListener('click', function() {
          Swal.fire({
            title: 'Cancel Payment?',
            text: 'Are you sure you want to cancel this payment?',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#BA0909',
            cancelButtonColor: '#6c757d',
            confirmButtonText: 'Yes, Cancel',
            cancelButtonText: 'Continue'
          }).then((result) => {
            if (result.isConfirmed) {
              window.location.href = 'index.html';
            }
          });
        });
      }
      
      // Initialize payment method
      setTimeout(function() {
        if (paymentMethodSelect && paymentMethodSelect.value) {
          paymentMethodSelect.dispatchEvent(new Event('change'));
        }
      }, 100);
    });
  </script>

</body>
</html>